<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WNY Admin - ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ (‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö)</title>
    <link rel="icon" href="https://upload.wikimedia.org/wikipedia/commons/1/15/Wny-logo.png">
    
    <script src="js/admin-guard.js"></script>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.1/chart.min.js"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="css/style.css">
</head>
<body class="p-4 sm:p-8 min-h-screen bg-gradient-to-br from-pink-100 to-blue-200 antialiased">
    <div id="app" class="max-w-6xl mx-auto">
        <div id="login-screen" class="hidden"></div>

        <div id="main-app" class="hidden">
            <header class="relative z-50 p-4 rounded-xl mb-6 flex flex-wrap justify-between items-center gap-4 bg-white/90 backdrop-blur shadow-sm border border-white/50">
                <div class="flex items-center gap-4">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/1/15/Wny-logo.png" alt="Logo" class="h-12 w-12 object-contain">
                    <div>
                        <h2 class="text-xl font-bold text-gray-800">Admin Console</h2>
                        <p class="text-sm text-gray-500">‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö: <span id="user-fullname">...</span></p>
                    </div>
                </div>
                
                <div class="flex items-center gap-4">
                    <button id="logout-button" class="btn btn-danger btn-sm">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
                </div>
            </header>

            <div id="navigation" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-4 mb-6">
                <button data-target="command-generation-page" id="admin-nav-command" class="nav-button p-4 text-center bg-white rounded-lg shadow hover:bg-indigo-50 transition">
                    <h3 class="font-bold text-purple-700">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á</h3>
                    <p class="text-xs text-gray-500">‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö</p>
                </button>
                 <button data-target="stats-page" id="nav-stats" class="nav-button p-4 text-center bg-white rounded-lg shadow hover:bg-indigo-50 transition">
                    <h3 class="font-bold text-green-700">‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h3>
                    <p class="text-xs text-gray-500">‡∏™‡∏£‡∏∏‡∏õ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°</p>
                </button>
                <button id="admin-nav-users" data-target="admin-users-page" class="nav-button p-4 text-center bg-white rounded-lg shadow hover:bg-indigo-50 transition">
                    <h3 class="font-bold text-red-700">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</h3>
                    <p class="text-xs text-gray-500">‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                </button>
            </div>
            
            <div id="admin-actions" class="mb-4 flex gap-2">
                 <button id="admin-sync-btn" class="btn bg-indigo-600 text-white shadow-lg hover:bg-indigo-700 transition">
                    üîÑ Sync ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏π‡πà Firebase
                </button>
            </div>
            
            <main id="page-content" class="p-6 sm:p-8 rounded-2xl">
                
                <div id="command-generation-page" class="page-view">
                    <h2 class="text-2xl font-bold mb-6">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á</h2>
                    
                    <div class="flex gap-4 mb-6">
                        <button id="admin-view-requests-tab" class="tab-button active">‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÑ‡∏õ‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£</button>
                        <button id="admin-view-memos-tab" class="tab-button">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</button>
                    </div>
                    
                    <div id="admin-requests-view">
                        <div class="mb-4">
                            <input type="text" id="admin-search-requests" class="form-input" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ñ‡∏≥‡∏Ç‡∏≠...">
                        </div>
                        <div id="admin-requests-list" class="space-y-4">
                            <div class="text-center p-8">
                                <div class="loader mx-auto"></div>
                                <p class="mt-4">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏≥‡∏Ç‡∏≠...</p>
                            </div>
                        </div>
                    </div>
                    
                    <div id="admin-memos-view" class="hidden">
                        <div class="mb-4">
                            <input type="text" id="admin-search-memos" class="form-input" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°...">
                        </div>
                        <div id="admin-memos-list" class="space-y-4">
                            <div class="text-center p-8">
                                <div class="loader mx-auto"></div>
                                <p class="mt-4">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°...</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="admin-users-page" class="page-view hidden">
                    <h2 class="text-2xl font-bold mb-6">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</h2>
                    <div class="mb-6 flex flex-wrap gap-4">
                        <button id="add-user-button" class="btn btn-primary">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</button>
                        <button id="download-user-template-button" class="btn bg-green-500 text-white">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö</button>
                        <button id="import-users-button" class="btn bg-blue-500 text-white">‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏à‡∏≤‡∏Å Excel</button>
                        <input type="file" id="user-excel-input" class="hidden" accept=".xlsx, .xls">
                    </div>
                    <div id="users-list" class="bg-white rounded-lg shadow">
                        <div id="users-content" class="p-4"></div>
                    </div>
                </div>
                
                <div id="stats-page" class="page-view hidden">
                    <h2 class="text-2xl font-bold mb-6">‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h2>
                    <div class="mb-6 flex flex-wrap gap-4">
                        <button id="refresh-stats" class="btn btn-primary">‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
                        <button id="export-stats" class="btn bg-green-500 text-white">‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</button>
                    </div>
                    <div id="stats-overview" class="space-y-6"></div>
                    <div id="stats-charts" class="mt-8 hidden">
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <div class="chart-container"><canvas id="requests-chart"></canvas></div>
                            <div class="chart-container"><canvas id="status-chart"></canvas></div>
                        </div>
                    </div>
                </div>

                <div id="admin-generate-command-page" class="page-view hidden">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡∏∞‡∏≠‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡πÑ‡∏õ‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£</h2>
                        <button id="back-to-admin-command" class="btn bg-gray-500 text-white">‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡∏™‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</button>
                    </div>
                    
                    <form id="admin-command-form">
                        <input type="hidden" id="admin-command-request-id">
                        
                        <fieldset class="border p-4 rounded-lg mb-6 bg-white/50">
                            <legend>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ)</legend>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                <div><label class="form-label">‡∏£‡∏´‡∏±‡∏™‡∏Ñ‡∏≥‡∏Ç‡∏≠</label><input type="text" id="admin-command-request-id-display" class="form-input bg-gray-100 text-gray-500" readonly></div>
                                <div><label class="form-label">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</label><input type="date" id="admin-command-doc-date" class="form-input"></div>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                <div><label class="form-label">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏Ç‡∏≠</label><input type="text" id="admin-command-requester-name" class="form-input"></div>
                                <div><label class="form-label">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</label><input type="text" id="admin-command-requester-position" class="form-input"></div>
                            </div>
                            <div class="mb-4"><label class="form-label">‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏õ‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£</label><input type="text" id="admin-command-location" class="form-input"></div>
                            <div class="mb-4"><label class="form-label">‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå</label><textarea id="admin-command-purpose" rows="2" class="form-input"></textarea></div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div><label class="form-label">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</label><input type="date" id="admin-command-start-date" class="form-input"></div>
                                <div><label class="form-label">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î</label><input type="date" id="admin-command-end-date" class="form-input"></div>
                            </div>
                        </fieldset>
                        
                        <fieldset class="border p-4 rounded-lg mb-6 bg-white/50">
                            <legend>‡∏ú‡∏π‡πâ‡∏£‡πà‡∏ß‡∏°‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ)</legend>
                            <div id="admin-command-attendees-list"></div>
                            <button type="button" id="admin-add-attendee-btn" class="btn btn-sm btn-success mt-2">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏π‡πâ‡∏£‡πà‡∏ß‡∏°‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á</button>
                        </fieldset>
                        
                        <input type="hidden" id="admin-expense-option"><input type="hidden" id="admin-expense-items"><input type="hidden" id="admin-total-expense"><input type="hidden" id="admin-vehicle-option"><input type="hidden" id="admin-license-plate">
                        
                        <fieldset class="border p-4 rounded-lg mb-6 bg-blue-50 border-blue-200">
                            <legend>‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á</legend>
                            <div class="space-y-3">
                                <div><input type="radio" id="admin-command-type-solo" name="admin-command-type" value="solo" class="h-4 w-4"><label for="admin-command-type-solo" class="ml-2">‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡πÄ‡∏î‡∏µ‡πà‡∏¢‡∏ß (1 ‡∏Ñ‡∏ô)</label></div>
                                <div><input type="radio" id="admin-command-type-group-small" name="admin-command-type" value="groupSmall" class="h-4 w-4"><label for="admin-command-type-group-small" class="ml-2">‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏•‡πá‡∏Å (2-5 ‡∏Ñ‡∏ô)</label></div>
                                <div><input type="radio" id="admin-command-type-group-large" name="admin-command-type" value="groupLarge" class="h-4 w-4"><label for="admin-command-type-group-large" class="ml-2">‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÉ‡∏´‡∏ç‡πà (6 ‡∏Ñ‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ)</label></div>
                            </div>
                        </fieldset>
                        
                        <div class="flex justify-center gap-4 mt-10 border-t pt-6 border-gray-200">
                            <button type="button" id="admin-generate-command-button" class="btn btn-primary text-lg shadow-lg">
                                <div id="admin-generate-command-loader" class="loader hidden"></div>
                                <span id="admin-generate-command-button-text">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á</span>
                            </button>
                        </div>
                    </form>
                    
                    <div id="admin-command-result" class="hidden mt-6 p-6 text-center bg-green-50 rounded-xl border border-green-200">
                        <h3 id="admin-command-result-title" class="font-bold text-lg text-green-800"></h3>
                        <p id="admin-command-result-message" class="mt-2 text-gray-700"></p>
                        <div class="flex justify-center flex-wrap gap-4 mt-4">
                            <a id="admin-command-result-link" href="#" target="_blank" class="btn btn-success transform hover:scale-105 transition">‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á</a>
                            <button onclick="switchPage('command-generation-page')" class="btn bg-gray-500 text-white">‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</button>
                        </div>
                    </div>
                </div>
            </main>
        </div></div>

        <div id="command-approval-modal" class="modal">
            <div class="modal-content">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold">‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡πÑ‡∏õ‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£</h3>
                    <button id="command-approval-modal-close-button" class="text-gray-500 hover:text-gray-700">&times;</button>
                </div>
                <form id="command-approval-form">
                    <input type="hidden" id="command-request-id">
                    <div class="mb-4">
                        <label class="form-label">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á</label>
                        <div class="space-y-2">
                            <div><input type="radio" id="command_type_solo" name="command_type" value="solo" class="h-4 w-4"><label for="command_type_solo" class="ml-2">‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡πÄ‡∏î‡∏µ‡πà‡∏¢‡∏ß (1 ‡∏Ñ‡∏ô)</label></div>
                            <div><input type="radio" id="command_type_group_small" name="command_type" value="groupSmall" class="h-4 w-4"><label for="command_type_group_small" class="ml-2">‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏•‡πá‡∏Å (2-5 ‡∏Ñ‡∏ô)</label></div>
                            <div><input type="radio" id="command_type_group_large" name="command_type" value="groupLarge" class="h-4 w-4"><label for="command_type_group_large" class="ml-2">‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÉ‡∏´‡∏ç‡πà (6 ‡∏Ñ‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ)</label></div>
                        </div>
                    </div>
                    <div class="flex justify-end gap-4">
                        <button type="button" id="command-approval-cancel-button" class="btn bg-gray-500 text-white">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                        <button type="submit" id="command-approval-submit-button" class="btn btn-primary">
                            <div id="command-approval-loader" class="loader hidden"></div>
                            <span>‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á</span>
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <div id="dispatch-modal" class="modal">
            <div class="modal-content">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏™‡πà‡∏á</h3>
                    <button id="dispatch-modal-close-button" class="text-gray-500 hover:text-gray-700">&times;</button>
                </div>
                <form id="dispatch-form">
                    <input type="hidden" id="dispatch-request-id">
                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <div>
                            <label for="dispatch-month" class="form-label">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</label>
                            <select id="dispatch-month" class="form-input" required>
                                <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô --</option>
                                <option value="‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°">‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°</option>
                                <option value="‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°">‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°</option>
                            </select>
                        </div>
                        <div><label for="dispatch-year" class="form-label">‡∏õ‡∏µ ‡∏û.‡∏®.</label><input type="number" id="dispatch-year" class="form-input" min="2560" max="2580" required></div>
                    </div>
                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <div><label for="command-count" class="form-label">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á</label><input type="number" id="command-count" class="form-input" min="0" required></div>
                        <div><label for="memo-count" class="form-label">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</label><input type="number" id="memo-count" class="form-input" min="0" required></div>
                    </div>
                    <div class="flex justify-end gap-4">
                        <button type="button" id="dispatch-cancel-button" class="btn bg-gray-500 text-white">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                        <button type="submit" id="dispatch-submit-button" class="btn btn-primary">
                            <div id="dispatch-loader" class="loader hidden"></div>
                            <span>‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏™‡πà‡∏á</span>
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <div id="admin-memo-action-modal" class="modal">
            <div class="modal-content">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</h3>
                    <button id="admin-memo-action-modal-close-button" class="text-gray-500 hover:text-gray-700">&times;</button>
                </div>
                <form id="admin-memo-action-form">
                    <input type="hidden" id="admin-memo-id">
                    <div class="mb-4">
                        <label for="admin-memo-status" class="form-label">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</label>
                        <select id="admin-memo-status" class="form-input" required>
                            <option value="‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
                            <option value="‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô/‡∏£‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô">‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô/‡∏£‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</option>
                            </select>
                    </div>
                    <div id="admin-file-uploads" class="space-y-4 hidden">
                        <div><label class="form-label">‡πÑ‡∏ü‡∏•‡πå‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå</label><input type="file" id="admin-completed-memo-file" class="form-input" accept=".pdf,.doc,.docx"></div>
                        <div><label class="form-label">‡πÑ‡∏ü‡∏•‡πå‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå</label><input type="file" id="admin-completed-command-file" class="form-input" accept=".pdf,.doc,.docx"></div>
                        <div><label class="form-label">‡πÑ‡∏ü‡∏•‡πå‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏™‡πà‡∏á</label><input type="file" id="admin-dispatch-book-file" class="form-input" accept=".pdf,.doc,.docx"></div>
                    </div>
                    <div class="flex justify-end gap-4">
                        <button type="button" id="admin-memo-cancel-button" class="btn bg-gray-500 text-white">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                        <button type="submit" id="admin-memo-submit-button" class="btn btn-primary">
                            <div id="admin-memo-loader" class="loader hidden"></div>
                            <span>‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</span>
                        </button>
                    </div>
                </form>
            </div>
        </div>
        
        <div id="register-modal" class="modal">
            <div class="modal-content">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÉ‡∏´‡∏°‡πà</h3>
                    <button id="register-modal-close-button" class="text-gray-500 hover:text-gray-700">&times;</button>
                </div>
                <form id="register-form">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div><label for="register-username" class="form-label">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</label><input type="text" id="register-username" class="form-input" required></div>
                        <div><label for="register-password" class="form-label">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</label><input type="password" id="register-password" class="form-input" required></div>
                    </div>
                    <div class="mb-4"><label for="register-fullname" class="form-label">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label><input type="text" id="register-fullname" class="form-input" required></div>
                    <div class="mb-4"><label for="register-position" class="form-label">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</label><input type="text" id="register-position" class="form-input" required></div>
                    <div class="mb-4"><label for="register-department" class="form-label">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏≤‡∏£‡∏∞/‡∏á‡∏≤‡∏ô</label><input type="text" id="register-department" class="form-input" required></div>
                    <div class="mb-4"><label for="register-email" class="form-label">‡∏≠‡∏µ‡πÄ‡∏°‡∏• (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô)</label><input type="email" id="register-email" class="form-input" required></div>
                    <div class="flex justify-end gap-4">
                        <button type="button" id="register-modal-close-button2" class="btn bg-gray-500 text-white">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                        <button type="submit" id="register-submit-button" class="btn btn-primary">
                            <div id="register-loader" class="loader hidden"></div>
                            <span>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</span>
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <div id="alert-modal" class="modal">
            <div class="modal-content">
                <div class="flex justify-between items-center mb-4">
                    <h3 id="alert-modal-title" class="text-xl font-bold">‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</h3>
                    <button id="alert-modal-close-button" class="text-gray-500 hover:text-gray-700">&times;</button>
                </div>
                <p id="alert-modal-message" class="mb-6"></p>
                <div class="flex justify-end">
                    <button id="alert-modal-ok-button" class="btn btn-primary">‡∏ï‡∏Å‡∏•‡∏á</button>
                </div>
            </div>
        </div>

        <div id="confirm-modal" class="modal">
            <div class="modal-content">
                <div class="flex justify-between items-center mb-4">
                    <h3 id="confirm-modal-title" class="text-xl font-bold">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</h3>
                    <button id="confirm-modal-close-button" class="text-gray-500 hover:text-gray-700">&times;</button>
                </div>
                <p id="confirm-modal-message" class="mb-6"></p>
                <div class="flex justify-end gap-4">
                    <button id="confirm-modal-no-button" class="btn bg-gray-500 text-white">‡πÑ‡∏°‡πà</button>
                    <button id="confirm-modal-yes-button" class="btn btn-primary">‡πÉ‡∏ä‡πà</button>
                </div>
            </div>
        </div>
        
    </div>
    
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>

    <script src="js/config.js"></script>          <script src="js/utils.js"></script>
    <script src="js/firebaseService.js"></script>  <script src="js/auth.js"></script>
    <script src="js/requests.js"></script>
    
    <script src="js/admin.js"></script>
    
    <script src="js/stats.js"></script>
    <script src="js/main.js"></script>
    <script src="https://unpkg.com/pizzip@3.1.4/dist/pizzip.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/docxtemplater/3.50.0/docxtemplater.js"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const userStr = sessionStorage.getItem('currentUser');
            if (userStr) {
                const user = JSON.parse(userStr);
                // ‡∏Ç‡πâ‡∏≤‡∏°‡∏´‡∏ô‡πâ‡∏≤ Login ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
                document.getElementById('login-screen').classList.add('hidden');
                document.getElementById('main-app').classList.remove('hidden');
                
                // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ä‡∏∑‡πà‡∏≠
                document.getElementById('user-fullname').textContent = user.fullName || 'Admin';
                
                // ‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏∏‡πà‡∏° Admin ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ (‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏´‡∏ô‡πâ‡∏≤ Admin ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß)
                document.querySelectorAll('.nav-button.hidden').forEach(btn => btn.classList.remove('hidden'));
                
                // ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤ Command ‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å
                switchPage('command-generation-page');
            }
        });
    </script>
</body>
</html>
